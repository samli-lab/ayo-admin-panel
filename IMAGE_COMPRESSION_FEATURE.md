# 图片压缩功能说明

## 功能概述

在相册管理的新增照片页面中，我们集成了专业的图片压缩功能。用户在选择图片后，会自动弹出压缩界面，可以预览压缩效果并选择是否使用压缩后的图片。

## 核心功能

### 1. 压缩参数调节
- **压缩质量**：10% - 100%，可通过滑块调节
- **目标大小**：0.1MB - 5MB，可设置压缩后的目标文件大小
- **实时重新压缩**：调整参数后可点击"重新压缩"按钮

### 2. 压缩信息展示
- 原始文件大小
- 压缩后文件大小
- 压缩率（百分比）

### 3. 图片对比预览
- 左侧：原始图片预览
- 右侧：压缩后图片预览
- 支持点击放大查看

### 4. 灵活的上传选项
- **使用压缩后的图片**：上传压缩后的版本
- **使用原图**：如果对压缩效果不满意，可以选择上传原始图片
- **取消**：放弃上传

## 使用的技术

### browser-image-compression
- 成熟的图片压缩库，支持多种图片格式（JPEG、PNG、WebP、BMP）
- 使用 Web Worker 实现多线程压缩，不阻塞主线程
- 版本：2.0.2

### 组件设计
- **ImageCompressor.tsx**：独立的压缩组件，可复用
- 使用 Semi Design UI 组件库
- 响应式设计，支持大屏预览

## 使用流程

1. 进入"相册管理 - 新增照片"页面
2. 点击上传按钮选择图片
3. 自动弹出压缩界面
4. 调整压缩参数（可选）
5. 查看压缩前后对比
6. 选择使用压缩图或原图
7. 系统自动上传选择的图片
8. 继续填写其他表单信息并保存

## 特点

- ✅ 先压缩后上传，减少网络传输时间
- ✅ 实时预览压缩效果
- ✅ 可调节的压缩参数
- ✅ 清晰的对比展示
- ✅ 灵活的上传选择
- ✅ 专业的UI设计
- ✅ 性能优化（Web Worker）

## 文件结构

```
src/
├── components/
│   └── ImageCompressor.tsx          # 图片压缩组件
└── pages/
    └── blog/
        └── gallery/
            └── create/
                └── index.tsx         # 新增照片页面（已集成）
```

## 配置说明

压缩参数可以根据实际需求调整：

```typescript
const options = {
  maxSizeMB: maxSizeValue,           // 目标文件大小（MB）
  maxWidthOrHeight: 1920,            // 最大宽度或高度（像素）
  useWebWorker: true,                // 使用 Web Worker
  initialQuality: qualityValue / 100 // 初始质量（0-1）
};
```

## 浏览器兼容性

支持所有现代浏览器：
- Chrome 60+
- Firefox 55+
- Safari 11+
- Edge 79+

## 注意事项

1. 压缩质量越低，文件越小，但可能导致图片失真
2. 建议根据实际使用场景选择合适的压缩参数
3. 对于已经高度压缩的图片，再次压缩可能效果不明显
4. 压缩过程在客户端进行，不会增加服务器负担
